'on error resume next

Set wshNetwork = CreateObject("WScript.Network")
Set WshShell = WScript.CreateObject("WScript.Shell")
Set GuyNet = WScript.CreateObject("WScript.Network")
Set CheckDrive = GuyNet.EnumNetworkDrives()


DriveLetter = "A:" 'DriveLetter must be a CAPITAL letter e.g. for drive A

RemotePath = "\\SERVER\Folder"

AlreadyConnected = False

'GuyNet.RemoveNetworkDrive DriveLetter

For i = 0 To CheckDrive.Count - 1 Step 2
  If CheckDrive.Item(i) = DriveLetter Then AlreadyConnected = True
Next

If AlreadyConnected = True then
  GuyNet.RemoveNetworkDrive DriveLetter
  GuyNet.MapNetworkDrive DriveLetter, RemotePath
Else
  GuyNet.MapNetworkDrive DriveLetter, RemotePath
End if
